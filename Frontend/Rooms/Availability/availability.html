<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Input Availability | ScheduleMate Pro</title>

    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="availability.css" />
    <link rel="icon" type="image/png" href="../../Images/favicon.png" />
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#6366f1" />
    <link rel="apple-touch-icon" href="/Images/favicon.png" />
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js")
            .then(() => console.log("App is ready for install"))
            .catch((err) => console.log("SW Fail", err));
        });
      }
    </script>
  </head>
  <body>
    <div class="bg-layer">
      <lottie-player
        src="../../Assets/calendar-bg.json"
        background="transparent"
        speed="1"
        style="width: 100%; height: 100%; opacity: 0.2"
        loop
        autoplay
      >
      </lottie-player>
    </div>

    <div class="glass-card">
      <header class="card-header">
        <button id="exitButton" class="back-pill">
          <span class="material-icons">arrow_back</span>
          <span>Room Hub</span>
        </button>

        <div class="title-group">
          <div class="icon-box avail-glow">
            <span class="material-icons">calendar_today</span>
          </div>
          <h1>My Availability</h1>
        </div>
      </header>

      <form id="availability-form" class="glass-form">
        <div id="creatorControls" class="creator-panel" style="display: none">
          <div class="panel-header">
            <span class="material-icons">admin_panel_settings</span>
            <h3>Room Preferences</h3>
          </div>
          <div class="input-group">
            <label for="interval">Meeting Duration</label>
            <select id="interval" class="glass-input">
              <option value="">Select duration...</option>
              <option value="1">1 Hour</option>
              <option value="2">2 Hours</option>
              <option value="3">3 Hours</option>
            </select>
          </div>
          <div class="input-group">
            <label for="preferred_day">Preferred Day</label>
            <select id="preferred_day" class="glass-input">
              <option value="">Select day...</option>
              <option value="Monday">Monday</option>
              <option value="Tuesday">Tuesday</option>
              <option value="Wednesday">Wednesday</option>
              <option value="Thursday">Thursday</option>
              <option value="Friday">Friday</option>
            </select>
          </div>
        </div>

        <div id="availabilityWrapper" class="member-panel">
          <div
            id="disabledOverlay"
            class="status-overlay"
            style="display: none"
          >
            <div class="status-box">
              <lottie-player
                src="../../Assets/Lock.json"
                background="transparent"
                speed="1"
                style="width: 80px; height: 80px"
                loop
                autoplay
              ></lottie-player>
              <p id="disabledMessage">
                Waiting for the Room Creator to set the meeting rules.
              </p>
            </div>
          </div>
          <div class="input-group">
            <label for="constrainedDayDisplay">Meeting Day</label>
            <div
              id="constrainedDayDisplay"
              class="read-only-field"
              style="display: none"
            ></div>
          </div>
          <div class="row-group">
            <div class="input-group">
              <label for="start_time">Start Time</label>
              <select id="start_time" class="glass-input" required>
                <option value="">-- : --</option>
              </select>
            </div>
            <div class="input-group">
              <label for="end_time">End Time</label>
              <select id="end_time" class="glass-input" required>
                <option value="">-- : --</option>
              </select>
            </div>
          </div>
          <div class="input-group">
            <label for="location">Preferred Location</label>
            <select id="location" class="glass-input" required>
              <option value="">Select Building...</option>
            </select>
          </div>
        </div>

        <button type="submit" class="submit-btn">
          <span class="material-icons">check</span> Confirm Availability
        </button>
      </form>
    </div>

    <div id="errorModal" class="modal-overlay">
      <div class="modal-box error">
        <h3 class="modal-title">Oops!</h3>
        <p id="errorMessage">Something went wrong.</p>
        <button id="errorOkBtn" class="modal-btn">Okay</button>
      </div>
    </div>

    <div id="successModal" class="modal-overlay">
      <div class="modal-box success">
        <lottie-player
          src="../../Assets/success.json"
          background="transparent"
          speed="1"
          style="width: 150px; height: 150px; margin: 0 auto"
          loop
          autoplay
        >
        </lottie-player>
        <h3 class="modal-title">Awesome!</h3>
        <p>Your availability has been saved.</p>
        <div class="modal-actions">
          <button id="viewSchedulerBtn" class="modal-btn primary">
            View Schedule
          </button>
          <button id="successExitBtn" class="modal-btn secondary">
            Back to Hub
          </button>
        </div>
      </div>
    </div>

    <script defer src="./availability.js"></script>
  </body>
</html>
